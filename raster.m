function raster( splist, range, color, figpos )%% Usage: raster( splist, <range>, <color>, <figpos> )%% splist is the list of spikes, with repeats separated by -1% (make sure all spikes are in positive times% % range = [TMIN TMAX] gives the time interval over which the raster should% be displayed%% if 'color' is used, assume plot raster on same figure%% Created 17 Apr 2003 DABif nargin < 3	color = [];endif nargin < 2	range = [];endif isempty(color)	color = 'b';endif ~isempty(range)	splist = splist((splist > range(1) & splist < range(2)) | (splist < 0));	if isempty(find(splist > 0))		disp( 'There are no spikes in that time range.')		return	endelse	range = [0 max(splist)*1.1];endif nargin < 4  figureelse	if length(figpos) == 3		subplot(figpos(1),figpos(2),figpos(3))	endendhold onif splist(end) > 0	splist(end+1) = -1;endrlocs = find(splist < 0);Nreps = length(rlocs);rlocs = [0 rlocs(:)'];y = 1;nspk = 0;for n = 1:Nreps  for i = (rlocs(n)+1):(rlocs(n+1)-1)    set(line,'XData',[1 1]*splist(i),'YData',-[y y+0.78],'Color',color)    nspk = nspk + 1;      end  y = y + 1;  endfprintf( '%d rows with %d spikes total.\n', y-1, nspk )hold offif nargin > 1  mint = range(1);  maxt = range(2);else  mint = floor(min(splist((splist > 0)))*4)/4;  if mint < 0    mint = 0;  end  maxt = ceil(max(splist)*4)/4;endaxis([mint maxt -(y+1)*1 0])set(gca,'LineWidth',0.6,'FontSize',8,'YTickLabel',[])